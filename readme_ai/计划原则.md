# Agent 计划原则

## 📈 Mermaid 图表生成原则

### 🎯 核心目标

确保 Agent (Roo) 生成的 Mermaid 图表语法正确、易于阅读、能够被顺利解析和渲染，从而清晰有效地传达流程、架构或概念。

### ⚠️ **关键原则：节点标签的正确引用**

**警示：Mermaid节点标签若包含特殊字符（包括但不限于：空格、圆括号 `()`、方括号 `[]`、花括号 `{}`、冒号 `:`、连字符 `-` 等）或 Mermaid 的保留关键字，则该标签文本必须用双引号 `""` 完整包裹。**

### 原因与后果

*   **原因**：Mermaid 解析器依赖严格的语法规则来区分节点ID、节点标签和连接符。未用引号正确包裹的特殊字符会干扰解析器对这些元素的识别。
*   **后果**：
    *   图表无法正确渲染。
    *   通常会导致解析错误，如 `Parse error on line X: ... Expecting 'TOKEN_A', got 'TOKEN_B'`。
    *   浪费用户的时间来纠正 Agent 的低级错误。

### 正确与错误示例

*   **错误示例 (会导致解析失败)**：
    ```mermaid
    graph TD
        A[Node with (parentheses) and: a colon] --> B[Another Node];
        C[Node - with hyphens] --> D;
    ```

*   **正确示例 (能够正确解析)**：
    ```mermaid
    graph TD
        A["Node with (parentheses) and: a colon"] --> B["Another Node"];
        C["Node - with hyphens"] --> D;
    ```
    或者，如果标签本身不含特殊字符，则可以不使用引号：
    ```mermaid
    graph TD
        SimpleNode --> AnotherSimpleNode;
    ```

### Agent (Roo) 的行动承诺

1.  **严格检查标签引用**：生成图表前，必须检查并确保所有含特殊字符的节点标签均已用双引号正确包裹。
2.  **优先简洁标签**：在保证清晰的前提下，尽量使用不含特殊字符的节点标签。
3.  **记录并改进**：若再犯此类错误，需记录具体案例并加深对此原则的理解和应用。

## 📏 其他辅助原则

1.  **遵守核心语法**：严格遵循所选图表类型（如 `graph TD`, `flowchart LR` 等）的基本语法，包括正确的箭头类型 (`-->`, `---`, `-.->` 等) 和连接文本的格式 (`-- text -->`)。
2.  **逐步验证**：对于复杂的图表，在内部构思时可以尝试先构建和验证核心骨架的语法正确性。

此原则旨在帮助 Agent (Roo) 持续改进 Mermaid 图表的生成质量。